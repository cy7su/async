<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Проекты {{ language.name }} - async.pw</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <nav class="navbar">
        <div class="nav-content">
            <a href="/" class="prompt">[async.pw]</a>
            <span style="color: #4ec9b0;"> ~$</span>
            <ul>
                <li><span class="nav-prefix">./</span><a href="/crystal">crystal</a></li>
                <li><span class="nav-prefix">./</span><a href="/rust">rust</a></li>
                <li><span class="nav-prefix">./</span><a href="/python">python</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <main class="content projects-page">
            <section class="projects-detail">
                <h1>Популярные проекты {{ language.name }}</h1>
                
                <div class="projects-content">
                    
                    {% for project in language.projects %}
                    <div class="project-item">
                        <h3 id="{{ project.name|lower|replace(' ', '-') }}">
                            {{ project.name }}
                            <a href="{{ project.github }}" target="_blank" class="github-btn" title="Открыть на GitHub">
                                <i class="devicon-github-original"></i>
                            </a>
                        </h3>
                        <p>{{ project.description }}</p>
                        
                           <div class="project-info">
                               <h4>Примеры использования:</h4>
                               {% if project.code_example %}
                                   {{ project.code_example | safe }}
                               {% endif %}
                           </div>
                    </div>
                    {% endfor %}
                </div>
                
                <div class="navigation-buttons">
                    <a href="/{{ language.slug }}" class="btn">← Назад к языку</a>
                    <a href="/{{ language.slug }}/history" class="btn">История разработки</a>
                </div>
            </section>
        </main>

        <aside class="sidebar">
            <div class="sidebar-content">
                <h3>
                    <i class="devicon-{{ language.icon }}-plain language-icon"></i>
                    {{ language.name }}
                </h3>
                <p>Популярные проекты</p>
                
                <div class="sidebar-stats">
                    <div class="stat-item">
                        <span class="stat-label">Время прочтения:</span>
                        <span class="stat-value">~10 мин</span>
                    </div>
                </div>
                
                <ul class="features">
                    {% for project in language.projects %}
                    <li>
                        {% set project_id = project.name|lower|replace(" ", "-") %}
                        <a href="#" onclick="highlightProject('{{ project_id }}')">{{ project.name }}</a>
                    </li>
                    {% endfor %}
                </ul>
                
                <div class="sidebar-info">
                    <h4>Статистика</h4>
                    <p>Всего проектов: {{ language.projects|length }}</p>
                    <p>Веб-фреймворки: 
                        {% set web_count = language.projects|selectattr('name', 'in', ['Django', 'FastAPI', 'Lucky Framework', 'Amber Framework', 'Actix Web', 'Kemal'])|list|length %}
                        {{ web_count }}
                    </p>
                    <p>Системные: 
                        {% set sys_count = language.projects|selectattr('name', 'in', ['Tokio', 'Serde', 'Rust Analyzer', 'Crystal HTTP'])|list|length %}
                        {{ sys_count }}
                    </p>
                </div>
                
                <p>By async.pw, {{ current_year }}</p>
            </div>
        </aside>
    </div>

    <script>
        let highlightTimeout = null;
        
        function highlightProject(projectId) {
            document.querySelectorAll('h3').forEach(h3 => {
                h3.classList.remove('highlighted');
            });
            
            if (highlightTimeout) {
                clearTimeout(highlightTimeout);
            }
            
            const header = document.getElementById(projectId);
            if (header) {
                header.classList.add('highlighted');
                
                const rect = header.getBoundingClientRect();
                const isVisible = rect.top >= 0 && rect.bottom <= window.innerHeight;
                
                if (!isVisible || rect.top < 100) {
                    const offsetTop = header.offsetTop - 100;
                    window.scrollTo({
                        top: offsetTop,
                        behavior: 'smooth'
                    });
                }
                
                highlightTimeout = setTimeout(() => {
                    header.classList.add('fade-out');
                    setTimeout(() => {
                        header.classList.remove('highlighted', 'fade-out');
                    }, 500);
                }, 3000);
            }
        }
    </script>
</body>
</html>